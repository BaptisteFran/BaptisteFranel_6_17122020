/*global module:false*/

/**
 * Turns an object literal into a string
 * @param csp {Object}
 * @returns {string}
 */
function cspString(csp) {

    "use strict";

    var str = "";

    for ( var i in csp ) {
        if ( csp.hasOwnProperty( i ) ) {
            str += i + " " + csp[i].join( " " ) + ";";
        }
    }

    return str;
}

/**
 * Set CSP Headers
 * @param csp {Object} Object literal
 * @param res {Object} The http response object
 */
function cspHeader( csp, res ) {

    "use strict";

    csp = cspString(csp);
    res.header( 'Content-Security-Policy', csp );

}

// export module
module.exports = {
    header : cspHeader
};